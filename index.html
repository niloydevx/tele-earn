<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ad Watch Reward</title>
<script src="https://ad.gigapub.tech/script?id=1872"></script>
<style>
body { font-family: Arial,sans-serif; background:#f9f9f9; text-align:center; padding:20px; }
#adContainer { position: relative; width: 320px; height: 250px; margin:auto; border:2px solid #ccc; border-radius:10px; overflow:hidden; background:#fff; display:none; }
#messageSection { margin-top:20px; display:none; font-size:18px; color:green; }
button { padding:10px 20px; border:none; border-radius:8px; cursor:pointer; background:dodgerblue; color:white; font-size:16px; }
button:disabled { background:gray; cursor:not-allowed; }
</style>
</head>
<body>

<h2>üéÅ Watch Ad to Get Reward</h2>

<button id="watchAdBtn">‚ñ∂Ô∏è Watch Ad</button>

<div id="adContainer">
  <div id="gigapub-ad"></div>
</div>

<div id="messageSection">‚úÖ Ad completed! Reward granted.</div>

<script>
let adCompleted = false;

// Warn on leaving mid-ad
window.onbeforeunload = () => {
  if (!adCompleted && sessionStorage.getItem('adStartTime')) {
    return "‚ùå You haven't completed the ad yet. Leaving will forfeit your reward!";
  }
};

document.getElementById("watchAdBtn").addEventListener("click", () => {
  // Prevent multiple clicks
  document.getElementById("watchAdBtn").disabled = true;

  const storedCompleted = sessionStorage.getItem('adCompleted');
  if(storedCompleted==='true'){
    adCompleted = true;
    document.getElementById("messageSection").style.display="block";
    return;
  }

  // Save start time
  sessionStorage.setItem('adStartTime', Date.now());

  // Show ad container
  document.getElementById("adContainer").style.display = "block";

  // Load Gigapub ad
  if(typeof window.showGiga==="function"){
    window.showGiga("gigapub-ad",{
      onComplete: ()=>{
        adCompleted = true;
        sessionStorage.setItem('adCompleted','true');
        document.getElementById("messageSection").style.display="block";
      },
      onError:()=>{
        alert("‚ùå Ad failed to load or complete. Reward cannot be granted.");
        document.getElementById("watchAdBtn").disabled = false;
      }
    });
  }else{
    console.error("GigaPub ad SDK not loaded properly.");
    alert("‚ùå Ad SDK not ready. Try again later.");
    document.getElementById("watchAdBtn").disabled = false;
  }
});
</script>

</body>
</html>
