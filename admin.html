<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Money Land - Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    :root {
      --primary-color: #ffd700;
      --accent-color: #ffdb4d;
      --dark-bg: #0a0a0a;
      --card-bg: linear-gradient(145deg, #111, #1a1a1a);
    }
    
    body {
      background: var(--dark-bg);
      color: #fff;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      padding-top: 20px;
    }
    
    .admin-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .card {
      background: var(--card-bg);
      border: none;
      border-radius: 18px;
      box-shadow: 0 6px 18px rgba(255, 215, 0, 0.15);
      color: var(--primary-color);
      overflow: hidden;
      margin-bottom: 20px;
    }
    
    .btn-admin {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: #000;
      font-weight: 600;
      border-radius: 14px;
      padding: 10px 20px;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
      border: none;
    }
    
    .btn-admin:hover {
      background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(255, 215, 0, 0.3);
    }
    
    .form-control, .form-select {
      background-color: rgba(0,0,0,0.5);
      border: 1px solid #333;
      color: var(--primary-color);
      padding: 10px 15px;
      border-radius: 12px;
    }
    
    .form-control:focus, .form-select:focus {
      background-color: rgba(0,0,0,0.7);
      border-color: var(--primary-color);
      color: var(--primary-color);
      box-shadow: 0 0 0 0.25rem rgba(255, 215, 0, 0.25);
    }
    
    .table-dark {
      --bs-table-bg: transparent;
      --bs-table-striped-bg: rgba(255, 215, 0, 0.05);
      --bs-table-hover-bg: rgba(255, 215, 0, 0.1);
    }
    
    .nav-pills .nav-link.active {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: #000;
      font-weight: 600;
    }
    
    .nav-pills .nav-link {
      color: var(--primary-color);
    }
    
    .preview-image {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 10px;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .vpn-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }
    
    .switch input { 
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: var(--primary-color);
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <div class="text-center mb-4">
      <h1 class="text-warning">Money Land Admin Panel</h1>
      <p class="text-muted">Manage your application settings and users</p>
    </div>
    
    <div class="row">
      <div class="col-md-3">
        <div class="card p-3">
          <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
            <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" data-bs-target="#v-pills-home" type="button" role="tab">Dashboard</button>
            <button class="nav-link" id="v-pills-app-tab" data-bs-toggle="pill" data-bs-target="#v-pills-app" type="button" role="tab">App Settings</button>
            <button class="nav-link" id="v-pills-surveys-tab" data-bs-toggle="pill" data-bs-target="#v-pills-surveys" type="button" role="tab">Surveys</button>
            <button class="nav-link" id="v-pills-withdrawals-tab" data-bs-toggle="pill" data-bs-target="#v-pills-withdrawals" type="button" role="tab">Withdrawals</button>
            <button class="nav-link" id="v-pills-users-tab" data-bs-toggle="pill" data-bs-target="#v-pills-users" type="button" role="tab">Users</button>
          </div>
        </div>
      </div>
      
      <div class="col-md-9">
        <div class="tab-content" id="v-pills-tabContent">
          <!-- Dashboard Tab -->
          <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel">
            <div class="card p-4">
              <h4 class="text-warning mb-4">Dashboard Overview</h4>
              
              <div class="row">
                <div class="col-md-4">
                  <div class="card p-3 text-center">
                    <i class="bi bi-people fs-1 mb-2 text-info"></i>
                    <h5>Total Users</h5>
                    <h3 class="fw-bold" id="totalUsers">0</h3>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card p-3 text-center">
                    <i class="bi bi-cash-coin fs-1 mb-2 text-success"></i>
                    <h5>Total Earnings</h5>
                    <h3 class="fw-bold" id="totalEarnings">0.00</h3>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="card p-3 text-center">
                    <i class="bi bi-wallet2 fs-1 mb-2 text-warning"></i>
                    <h5>Pending Withdrawals</h5>
                    <h3 class="fw-bold" id="pendingWithdrawals">0</h3>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- App Settings Tab -->
          <div class="tab-pane fade" id="v-pills-app" role="tabpanel">
            <div class="card p-4">
              <h4 class="text-warning mb-4">Application Settings</h4>
              
              <div class="mb-3">
                <label class="form-label">Daily Tasks Limit</label>
                <input type="number" class="form-control" id="dailyLimit" value="60">
              </div>
              
              <div class="mb-3">
                <label class="form-label">Minimum Withdrawal (BDT)</label>
                <input type="number" class="form-control" id="minWithdraw" value="50">
              </div>
              
              <div class="mb-3">
                <label class="form-label">Logo Image URL</label>
                <input type="text" class="form-control" id="logoUrl">
                <div class="form-text">Current Logo:</div>
                <img id="logoPreview" class="preview-image mt-2" src="">
              </div>
              
              <div class="mb-3">
                <label class="form-label">Cover Image URL</label>
                <input type="text" class="form-control" id="coverUrl">
                <div class="form-text">Current Cover:</div>
                <img id="coverPreview" class="preview-image mt-2" src="">
              </div>
              
              <div class="mb-3">
                <label class="form-label">VPN Requirement</label>
                <div class="vpn-toggle">
                  <label class="switch">
                    <input type="checkbox" id="vpnToggle">
                    <span class="slider"></span>
                  </label>
                  <span id="vpnStatusText">VPN Required: ON</span>
                </div>
              </div>
              
              <button class="btn btn-admin" onclick="saveAppSettings()">Save Settings</button>
            </div>
          </div>
          
          <!-- Surveys Tab -->
          <div class="tab-pane fade" id="v-pills-surveys" role="tabpanel">
            <div class="card p-4">
              <h4 class="text-warning mb-4">Manage Surveys</h4>
              
              <div class="mb-4">
                <h5>Add New Survey</h5>
                <div class="row">
                  <div class="col-md-4">
                    <div class="mb-3">
                      <label class="form-label">Survey Name</label>
                      <input type="text" class="form-control" id="surveyName">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="mb-3">
                      <label class="form-label">Reward (BDT)</label>
                      <input type="number" step="0.01" class="form-control" id="surveyReward">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="mb-3">
                      <label class="form-label">Image URL</label>
                      <input type="text" class="form-control" id="surveyImage">
                    </div>
                  </div>
                </div>
                <button class="btn btn-admin" onclick="addSurvey()">Add Survey</button>
              </div>
              
              <h5>Current Surveys</h5>
              <div class="table-responsive">
                <table class="table table-dark">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Reward</th>
                      <th>Image</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="surveysList">
                    <!-- Surveys will be listed here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Withdrawals Tab -->
          <div class="tab-pane fade" id="v-pills-withdrawals" role="tabpanel">
            <div class="card p-4">
              <h4 class="text-warning mb-4">Withdrawal Requests</h4>
              
              <div class="table-responsive">
                <table class="table table-dark">
                  <thead>
                    <tr>
                      <th>User ID</th>
                      <th>Amount</th>
                      <th>Method</th>
                      <th>Address</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="withdrawalsList">
                    <!-- Withdrawals will be listed here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <!-- Users Tab -->
          <div class="tab-pane fade" id="v-pills-users" role="tabpanel">
            <div class="card p-4">
              <h4 class="text-warning mb-4">User Management</h4>
              
              <div class="mb-3">
                <input type="text" class="form-control" placeholder="Search users by ID" id="userSearch">
              </div>
              
              <div class="table-responsive">
                <table class="table table-dark">
                  <thead>
                    <tr>
                      <th>User ID</th>
                      <th>Username</th>
                      <th>Balance</th>
                      <th>Earnings</th>
                      <th>Withdrawn</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="usersList">
                    <!-- Users will be listed here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Firebase configuration (same as in main app)
    const firebaseConfig = {
  apiKey: "AIzaSyDuaWMh0eIJ2tdtLxYj43ij9MGSh_Yo22M",
  authDomain: "test-6977e.firebaseapp.com",
  projectId: "test-6977e",
  storageBucket: "test-6977e.firebasestorage.app",
  messagingSenderId: "544329273038",
  appId: "1:544329273038:web:c7a31e12bec7c80741ca9f"
};

    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    // App state
    let appConfig = null;
    let bannedUsers = [];
    
    // Initialize the admin panel
    document.addEventListener("DOMContentLoaded", function() {
      loadAppConfig();
      loadSurveys();
      loadWithdrawals();
      loadUsers();
      updateDashboard();
      
      // Add event listener for user search
      document.getElementById("userSearch").addEventListener("input", loadUsers);
    });
    
    // Load app configuration from Firebase
    function loadAppConfig() {
      database.ref('appConfig').once('value', (snapshot) => {
        appConfig = snapshot.val();
        
        if (!appConfig) {
          // Default configuration if none exists
          appConfig = {
            dailyLimit: 60,
            minWithdraw: 50,
            logo: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg",
            cover: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg",
            surveys: [
              { id: 1, name: "Tap_Cash", reward: 0.30, image: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg" },
              { id: 2, name: "Survey 2", reward: 0.50, image: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg" },
              { id: 3, name: "Survey 3", reward: 1.00, image: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg" },
              { id: 4, name: "Survey 4", reward: 2.00, image: "https://res.cloudinary.com/demo/image/upload/v1648039207/sample.jpg" }
            ],
            vpnRequired: true
          };
          
          // Save default config to Firebase
          database.ref('appConfig').set(appConfig);
        }
        
        // Apply app configuration to form
        document.getElementById("dailyLimit").value = appConfig.dailyLimit;
        document.getElementById("minWithdraw").value = appConfig.minWithdraw;
        document.getElementById("logoUrl").value = appConfig.logo;
        document.getElementById("coverUrl").value = appConfig.cover;
        document.getElementById("logoPreview").src = appConfig.logo;
        document.getElementById("coverPreview").src = appConfig.cover;
        
        // Set VPN toggle
        document.getElementById("vpnToggle").checked = appConfig.vpnRequired !== undefined ? appConfig.vpnRequired : true;
        document.getElementById("vpnStatusText").textContent = `VPN Required: ${document.getElementById("vpnToggle").checked ? 'ON' : 'OFF'}`;
        
        // Add event listener for VPN toggle
        document.getElementById("vpnToggle").addEventListener("change", function() {
          document.getElementById("vpnStatusText").textContent = `VPN Required: ${this.checked ? 'ON' : 'OFF'}`;
        });
      });
    }
    
    function saveAppSettings() {
      appConfig.dailyLimit = parseInt(document.getElementById("dailyLimit").value);
      appConfig.minWithdraw = parseInt(document.getElementById("minWithdraw").value);
      appConfig.logo = document.getElementById("logoUrl").value;
      appConfig.cover = document.getElementById("coverUrl").value;
      appConfig.vpnRequired = document.getElementById("vpnToggle").checked;
      
      database.ref('appConfig').set(appConfig)
        .then(() => {
          // Update previews
          document.getElementById("logoPreview").src = appConfig.logo;
          document.getElementById("coverPreview").src = appConfig.cover;
          
          alert("Settings saved successfully!");
        })
        .catch((error) => {
          console.error("Error saving settings:", error);
          alert("Error saving settings. Please try again.");
        });
    }
    
    function loadSurveys() {
      const surveysList = document.getElementById("surveysList");
      surveysList.innerHTML = "";
      
      if (!appConfig || !appConfig.surveys) return;
      
      appConfig.surveys.forEach(survey => {
        const row = `
          <tr>
            <td>${survey.id}</td>
            <td>${survey.name}</td>
            <td>${survey.reward} BDT</td>
            <td><img src="${survey.image}" width="50" height="50" style="object-fit: cover;"></td>
            <td>
              <button class="btn btn-sm btn-warning me-1" onclick="editSurvey(${survey.id})">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="deleteSurvey(${survey.id})">Delete</button>
            </td>
          </tr>
        `;
        surveysList.innerHTML += row;
      });
    }
    
    function addSurvey() {
      const name = document.getElementById("surveyName").value;
      const reward = parseFloat(document.getElementById("surveyReward").value);
      const image = document.getElementById("surveyImage").value;
      
      if (!name || !reward || !image) {
        alert("Please fill all fields!");
        return;
      }
      
      const newId = appConfig.surveys.length > 0 ? Math.max(...appConfig.surveys.map(s => s.id)) + 1 : 1;
      
      appConfig.surveys.push({
        id: newId,
        name,
        reward,
        image
      });
      
      database.ref('appConfig').set(appConfig)
        .then(() => {
          loadSurveys();
          
          // Clear form
          document.getElementById("surveyName").value = "";
          document.getElementById("surveyReward").value = "";
          document.getElementById("surveyImage").value = "";
          
          alert("Survey added successfully!");
        })
        .catch((error) => {
          console.error("Error adding survey:", error);
          alert("Error adding survey. Please try again.");
        });
    }
    
    function editSurvey(id) {
      const survey = appConfig.surveys.find(s => s.id === id);
      if (!survey) return;
      
      const newName = prompt("Enter new name:", survey.name);
      if (newName === null) return;
      
      const newReward = parseFloat(prompt("Enter new reward:", survey.reward));
      if (isNaN(newReward)) return;
      
      const newImage = prompt("Enter new image URL:", survey.image);
      if (newImage === null) return;
      
      survey.name = newName;
      survey.reward = newReward;
      survey.image = newImage;
      
      database.ref('appConfig').set(appConfig)
        .then(() => {
          loadSurveys();
          alert("Survey updated successfully!");
        })
        .catch((error) => {
          console.error("Error updating survey:", error);
          alert("Error updating survey. Please try again.");
        });
    }
    
    function deleteSurvey(id) {
      if (!confirm("Are you sure you want to delete this survey?")) return;
      
      appConfig.surveys = appConfig.surveys.filter(s => s.id !== id);
      
      database.ref('appConfig').set(appConfig)
        .then(() => {
          loadSurveys();
          alert("Survey deleted successfully!");
        })
        .catch((error) => {
          console.error("Error deleting survey:", error);
          alert("Error deleting survey. Please try again.");
        });
    }
    
    function loadWithdrawals() {
      const withdrawalsList = document.getElementById("withdrawalsList");
      withdrawalsList.innerHTML = "";
      
      // Get all users' withdrawal history
      database.ref('users').once('value', (snapshot) => {
        const users = snapshot.val();
        let allWithdrawals = [];
        
        if (users) {
          Object.keys(users).forEach(userId => {
            const user = users[userId];
            if (user.history) {
              const userWithdrawals = user.history.filter(item => item.type === "withdrawal");
              
              userWithdrawals.forEach(withdrawal => {
                withdrawal.userId = userId;
                allWithdrawals.push(withdrawal);
              });
            }
          });
        }
        
        // Sort by date (newest first)
        allWithdrawals.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        allWithdrawals.forEach(withdrawal => {
          const statusClass = withdrawal.status === "Pending" ? "text-warning" : 
                            withdrawal.status === "Completed" ? "text-success" : "text-danger";
          
          const row = `
            <tr>
              <td>${withdrawal.userId}</td>
              <td>${withdrawal.amount} BDT</td>
              <td>${withdrawal.method}</td>
              <td>${withdrawal.address}</td>
              <td>${withdrawal.date}</td>
              <td class="${statusClass}">${withdrawal.status}</td>
              <td>
                ${withdrawal.status === "Pending" ? `
                  <button class="btn btn-sm btn-success me-1" onclick="approveWithdrawal('${withdrawal.userId}', '${withdrawal.date}', '${withdrawal.amount}')">Approve</button>
                  <button class="btn btn-sm btn-danger" onclick="rejectWithdrawal('${withdrawal.userId}', '${withdrawal.date}')">Reject</button>
                ` : ''}
              </td>
            </tr>
          `;
          withdrawalsList.innerHTML += row;
        });
      });
    }
    
    function approveWithdrawal(userId, date, amount) {
      // Get the user's data
      database.ref('users/' + userId).once('value', (snapshot) => {
        const user = snapshot.val();
        
        if (user && user.history) {
          // Find the specific withdrawal
          const withdrawalIndex = user.history.findIndex(item => 
            item.type === "withdrawal" && item.date === date && item.amount === amount
          );
          
          if (withdrawalIndex !== -1) {
            // Update the status
            user.history[withdrawalIndex].status = "Completed";
            
            // Update in Firebase
            database.ref('users/' + userId).set(user)
              .then(() => {
                loadWithdrawals();
                alert("Withdrawal approved successfully!");
              })
              .catch((error) => {
                console.error("Error approving withdrawal:", error);
                alert("Error approving withdrawal. Please try again.");
              });
          }
        }
      });
    }
    
    function rejectWithdrawal(userId, date) {
      // Get the user's data
      database.ref('users/' + userId).once('value', (snapshot) => {
        const user = snapshot.val();
        
        if (user && user.history) {
          // Find the specific withdrawal
          const withdrawalIndex = user.history.findIndex(item => 
            item.type === "withdrawal" && item.date === date
          );
          
          if (withdrawalIndex !== -1) {
            // Return the amount to user's balance
            const withdrawalAmount = parseFloat(user.history[withdrawalIndex].amount);
            user.balance += withdrawalAmount;
            
            // Update status to Rejected
            user.history[withdrawalIndex].status = "Rejected";
            
            // Update in Firebase
            database.ref('users/' + userId).set(user)
              .then(() => {
                loadWithdrawals();
                alert("Withdrawal rejected and amount returned to user!");
              })
              .catch((error) => {
                console.error("Error rejecting withdrawal:", error);
                alert("Error rejecting withdrawal. Please try again.");
              });
          }
        }
      });
    }
    
    function loadUsers() {
      const usersList = document.getElementById("usersList");
      usersList.innerHTML = "";
      
      const searchTerm = document.getElementById("userSearch").value.toLowerCase();
      
      // Get all users
      database.ref('users').once('value', (snapshot) => {
        const users = snapshot.val();
        
        if (users) {
          // Get banned users list
          database.ref('bannedUsers').once('value', (bannedSnapshot) => {
            bannedUsers = bannedSnapshot.val() || [];
            
            Object.keys(users).forEach(userId => {
              const user = users[userId];
              
              // Filter by search term if provided
              if (searchTerm && !userId.toLowerCase().includes(searchTerm) && 
                  !user.username.toLowerCase().includes(searchTerm)) {
                return;
              }
              
              // Check if user is banned
              const isBanned = bannedUsers.includes(userId);
              
              const status = isBanned ? 
                '<span class="text-danger">Banned</span>' : 
                '<span class="text-success">Active</span>';
              
              const actions = isBanned ? 
                `<button class="btn btn-sm btn-success" onclick="unbanUser('${userId}')">Unban</button>` :
                `<button class="btn btn-sm btn-danger" onclick="banUser('${userId}')">Ban</button>`;
              
              const row = `
                <tr>
                  <td>${userId}</td>
                  <td>${user.username || 'N/A'}</td>
                  <td>${user.balance ? user.balance.toFixed(2) : '0.00'} BDT</td>
                  <td>${user.totalEarnings ? user.totalEarnings.toFixed(2) : '0.00'} BDT</td>
                  <td>${user.withdrawn ? user.withdrawn.toFixed(2) : '0.00'} BDT</td>
                  <td>${status}</td>
                  <td>${actions}</td>
                </tr>
              `;
              usersList.innerHTML += row;
            });
          });
        }
      });
    }
    
    function banUser(userId) {
      if (!confirm("Are you sure you want to ban this user?")) return;
      
      if (!bannedUsers.includes(userId)) {
        bannedUsers.push(userId);
        database.ref('bannedUsers').set(bannedUsers)
          .then(() => {
            loadUsers();
            alert("User banned successfully!");
          })
          .catch((error) => {
            console.error("Error banning user:", error);
            alert("Error banning user. Please try again.");
          });
      }
    }
    
    function unbanUser(userId) {
      if (!confirm("Are you sure you want to unban this user?")) return;
      
      bannedUsers = bannedUsers.filter(id => id !== userId);
      database.ref('bannedUsers').set(bannedUsers)
        .then(() => {
          loadUsers();
          alert("User unbanned successfully!");
        })
        .catch((error) => {
          console.error("Error unbanning user:", error);
          alert("Error unbanning user. Please try again.");
        });
    }
    
    function updateDashboard() {
      // Calculate total users, earnings, and pending withdrawals
      database.ref('users').once('value', (snapshot) => {
        const users = snapshot.val();
        let totalUsers = 0;
        let totalEarnings = 0;
        let pendingWithdrawals = 0;
        
        if (users) {
          totalUsers = Object.keys(users).length;
          
          Object.keys(users).forEach(userId => {
            const user = users[userId];
            
            if (user.totalEarnings) {
              totalEarnings += user.totalEarnings;
            }
            
            if (user.history) {
              user.history.forEach(item => {
                if (item.type === "withdrawal" && item.status === "Pending") {
                  pendingWithdrawals++;
                }
              });
            }
          });
        }
        
        document.getElementById("totalUsers").textContent = totalUsers;
        document.getElementById("totalEarnings").textContent = totalEarnings.toFixed(2);
        document.getElementById("pendingWithdrawals").textContent = pendingWithdrawals;
      });
    }
  </script>
</body>
</html>